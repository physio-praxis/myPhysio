{
  "id": "a1a76faf-97f9-4fcf-9d99-14d17448bd2d",
  "prevId": "878f24a2-ea06-4375-9335-4e1745c362c9",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.auth_user": {
      "name": "auth_user",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "supabase_user_id": {
          "name": "supabase_user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "auth_user_supabase_user_id_unique": {
          "name": "auth_user_supabase_user_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "supabase_user_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.customer": {
      "name": "customer",
      "schema": "",
      "columns": {
        "customer_id": {
          "name": "customer_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "first_name": {
          "name": "first_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_name": {
          "name": "last_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "street": {
          "name": "street",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "additional_address": {
          "name": "additional_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "postalCode": {
          "name": "postalCode",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "city": {
          "name": "city",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "country": {
          "name": "country",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "ix_customer_created_id": {
          "name": "ix_customer_created_id",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "customer_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_first_name": {
          "name": "ix_customer_first_name",
          "columns": [
            {
              "expression": "first_name",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_last_name": {
          "name": "ix_customer_last_name",
          "columns": [
            {
              "expression": "last_name",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_email": {
          "name": "ix_customer_email",
          "columns": [
            {
              "expression": "email",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_phone": {
          "name": "ix_customer_phone",
          "columns": [
            {
              "expression": "phone_number",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_city": {
          "name": "ix_customer_city",
          "columns": [
            {
              "expression": "city",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_customer_street": {
          "name": "ix_customer_street",
          "columns": [
            {
              "expression": "street",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.customer_consent": {
      "name": "customer_consent",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "customer_id": {
          "name": "customer_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "storage_bucket": {
          "name": "storage_bucket",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "storage_key": {
          "name": "storage_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "filename": {
          "name": "filename",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "mime_type": {
          "name": "mime_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "size_bytes": {
          "name": "size_bytes",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "sha256_hex": {
          "name": "sha256_hex",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "is_latest": {
          "name": "is_latest",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "uploaded_at": {
          "name": "uploaded_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "customer_consent_customer_id_customer_customer_id_fk": {
          "name": "customer_consent_customer_id_customer_customer_id_fk",
          "tableFrom": "customer_consent",
          "tableTo": "customer",
          "columnsFrom": [
            "customer_id"
          ],
          "columnsTo": [
            "customer_id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.invoice": {
      "name": "invoice",
      "schema": "",
      "columns": {
        "invoice_id": {
          "name": "invoice_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "date_issued": {
          "name": "date_issued",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "amount": {
          "name": "amount",
          "type": "numeric(12, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "customer_id": {
          "name": "customer_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_invoice_customer": {
          "name": "idx_invoice_customer",
          "columns": [
            {
              "expression": "customer_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_invoice_date": {
          "name": "idx_invoice_date",
          "columns": [
            {
              "expression": "date_issued",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_invoice_customer_date": {
          "name": "idx_invoice_customer_date",
          "columns": [
            {
              "expression": "customer_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "date_issued",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "invoice_customer_id_customer_customer_id_fk": {
          "name": "invoice_customer_id_customer_customer_id_fk",
          "tableFrom": "invoice",
          "tableTo": "customer",
          "columnsFrom": [
            "customer_id"
          ],
          "columnsTo": [
            "customer_id"
          ],
          "onDelete": "restrict",
          "onUpdate": "cascade"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.pet": {
      "name": "pet",
      "schema": "",
      "columns": {
        "pet_id": {
          "name": "pet_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "species_id": {
          "name": "species_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "breed": {
          "name": "breed",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "age": {
          "name": "age",
          "type": "date",
          "primaryKey": false,
          "notNull": false
        },
        "medical_history": {
          "name": "medical_history",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "customer_id": {
          "name": "customer_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "ix_pet_customer_id": {
          "name": "ix_pet_customer_id",
          "columns": [
            {
              "expression": "customer_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_pet_species_id": {
          "name": "ix_pet_species_id",
          "columns": [
            {
              "expression": "species_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_pet_name": {
          "name": "ix_pet_name",
          "columns": [
            {
              "expression": "name",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ix_pet_breed": {
          "name": "ix_pet_breed",
          "columns": [
            {
              "expression": "breed",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "pet_species_id_species_species_id_fk": {
          "name": "pet_species_id_species_species_id_fk",
          "tableFrom": "pet",
          "tableTo": "species",
          "columnsFrom": [
            "species_id"
          ],
          "columnsTo": [
            "species_id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "pet_customer_id_customer_customer_id_fk": {
          "name": "pet_customer_id_customer_customer_id_fk",
          "tableFrom": "pet",
          "tableTo": "customer",
          "columnsFrom": [
            "customer_id"
          ],
          "columnsTo": [
            "customer_id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.pet_treatment": {
      "name": "pet_treatment",
      "schema": "",
      "columns": {
        "pet_treatment_id": {
          "name": "pet_treatment_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "pet_id": {
          "name": "pet_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "treatment_id": {
          "name": "treatment_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "invoice_id": {
          "name": "invoice_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_pettreatment_pet": {
          "name": "idx_pettreatment_pet",
          "columns": [
            {
              "expression": "pet_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_pettreatment_treatment": {
          "name": "idx_pettreatment_treatment",
          "columns": [
            {
              "expression": "treatment_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_pettreatment_invoice": {
          "name": "idx_pettreatment_invoice",
          "columns": [
            {
              "expression": "invoice_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "pet_treatment_pet_id_pet_pet_id_fk": {
          "name": "pet_treatment_pet_id_pet_pet_id_fk",
          "tableFrom": "pet_treatment",
          "tableTo": "pet",
          "columnsFrom": [
            "pet_id"
          ],
          "columnsTo": [
            "pet_id"
          ],
          "onDelete": "cascade",
          "onUpdate": "cascade"
        },
        "pet_treatment_treatment_id_treatment_treatment_id_fk": {
          "name": "pet_treatment_treatment_id_treatment_treatment_id_fk",
          "tableFrom": "pet_treatment",
          "tableTo": "treatment",
          "columnsFrom": [
            "treatment_id"
          ],
          "columnsTo": [
            "treatment_id"
          ],
          "onDelete": "restrict",
          "onUpdate": "cascade"
        },
        "pet_treatment_invoice_id_invoice_invoice_id_fk": {
          "name": "pet_treatment_invoice_id_invoice_invoice_id_fk",
          "tableFrom": "pet_treatment",
          "tableTo": "invoice",
          "columnsFrom": [
            "invoice_id"
          ],
          "columnsTo": [
            "invoice_id"
          ],
          "onDelete": "set null",
          "onUpdate": "cascade"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.species": {
      "name": "species",
      "schema": "",
      "columns": {
        "species_id": {
          "name": "species_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "ix_species_name": {
          "name": "ix_species_name",
          "columns": [
            {
              "expression": "name",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.treatment": {
      "name": "treatment",
      "schema": "",
      "columns": {
        "treatment_id": {
          "name": "treatment_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "varchar(200)",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.user_session": {
      "name": "user_session",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {},
      "foreignKeys": {
        "user_session_user_id_auth_user_id_fk": {
          "name": "user_session_user_id_auth_user_id_fk",
          "tableFrom": "user_session",
          "tableTo": "auth_user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {
    "public.customer_details_view": {
      "columns": {
        "customer_id": {
          "name": "customer_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "first_name": {
          "name": "first_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_name": {
          "name": "last_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "street": {
          "name": "street",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "additional_address": {
          "name": "additional_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "postalCode": {
          "name": "postalCode",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "city": {
          "name": "city",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "country": {
          "name": "country",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "filename": {
          "name": "filename",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "uploaded_at": {
          "name": "uploaded_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "definition": "select \"customer\".\"customer_id\", \"customer\".\"created_at\", \"customer\".\"first_name\", \"customer\".\"last_name\", \"customer\".\"email\", \"customer\".\"phone_number\", \"customer\".\"street\", \"customer\".\"additional_address\", \"customer\".\"postalCode\", \"customer\".\"city\", \"customer\".\"country\", (\"customer_consent\".\"id\" IS NOT NULL) as \"has_consent\", \"customer_consent\".\"filename\", \"customer_consent\".\"uploaded_at\", \n\t\t\t\t\tCOALESCE(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT jsonb_agg(\n\t\t\t\t\t\t\t\tjsonb_build_object(\n\t\t\t\t\t\t\t\t\t'petId', p.pet_id,\n\t\t\t\t\t\t\t\t\t'name', p.name,\n\t\t\t\t\t\t\t\t\t'speciesId', p.species_id,\n\t\t\t\t\t\t\t\t\t'species', s.name,\n\t\t\t\t\t\t\t\t\t'breed', p.breed,\n\t\t\t\t\t\t\t\t\t'age', p.age::text,\n\t\t\t\t\t\t\t\t\t'medicalHistory', p.medical_history\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tORDER BY p.created_at DESC, p.pet_id\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\tFROM public.pet p\n\t\t\t\t\t\t\tLEFT JOIN public.species s ON s.species_id = p.species_id\n\t\t\t\t\t\t\tWHERE p.customer_id = \"customer\".\"customer_id\"\n\t\t\t\t\t\t), '[]'::jsonb\n\t\t\t\t\t)\n\t\t\t\t as \"pets\", \n\t\t\t\t\tCOALESCE(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT jsonb_agg(\n\t\t\t\t\t\t\t\tjsonb_build_object(\n\t\t\t\t\t\t\t\t\t'petTreatmentId', t5.pet_treatment_id,\n\t\t\t\t\t\t\t\t\t'createdAt', t5.created_at,\n\t\t\t\t\t\t\t\t\t'petId', t5.pet_id,\n\t\t\t\t\t\t\t\t\t'petName', t5.pet_name,\n\t\t\t\t\t\t\t\t\t'treatmentId', t5.treatment_id,\n\t\t\t\t\t\t\t\t\t'treatmentName', t5.treatment_name,\n\t\t\t\t\t\t\t\t\t'invoiceId', t5.invoice_id,\n\t\t\t\t\t\t\t\t\t'invoiceAmount', t5.invoice_amount,\n\t\t\t\t\t\t\t\t\t'invoiceDate', t5.invoice_date\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tORDER BY t5.created_at DESC, t5.pet_treatment_id\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\tFROM (\n\t\t\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\t\tpt.pet_treatment_id AS pet_treatment_id,\n\t\t\t\t\t\t\t\t\tpt.created_at AS created_at,\n\t\t\t\t\t\t\t\t\tpt.pet_id AS pet_id,\n\t\t\t\t\t\t\t\t\tp.name AS pet_name,\n\t\t\t\t\t\t\t\t\tt.treatment_id AS treatment_id,\n\t\t\t\t\t\t\t\t\tt.name AS treatment_name,\n\t\t\t\t\t\t\t\t\tpt.invoice_id AS invoice_id,\n\t\t\t\t\t\t\t\t\ti.amount::text AS invoice_amount,\n\t\t\t\t\t\t\t\t\ti.date_issued AS invoice_date\n\t\t\t\t\t\t\t\tFROM public.pet_treatment pt\n\t\t\t\t\t\t\t\tJOIN public.pet p ON p.pet_id = pt.pet_id\n\t\t\t\t\t\t\t\tJOIN public.treatment t ON t.treatment_id = pt.treatment_id\n\t\t\t\t\t\t\t\tLEFT JOIN public.invoice i ON i.invoice_id = pt.invoice_id\n\t\t\t\t\t\t\t\tWHERE p.customer_id = \"customer\".\"customer_id\"\n\t\t\t\t\t\t\t\tORDER BY pt.created_at DESC, pt.pet_treatment_id DESC\n\t\t\t\t\t\t\t\tLIMIT 5\n\t\t\t\t\t\t\t) AS t5\n\t\t\t\t\t\t), '[]'::jsonb\n\t\t\t\t\t)\n\t\t\t\t as \"last5_treatments\" from \"customer\" left join \"customer_consent\" on (\"customer_consent\".\"customer_id\" = \"customer\".\"customer_id\" and (\"customer_consent\".\"is_latest\") = TRUE)",
      "name": "customer_details_view",
      "schema": "public",
      "isExisting": false,
      "with": {
        "securityInvoker": true
      },
      "materialized": false
    },
    "public.customer_search_view": {
      "columns": {
        "customer_id": {
          "name": "customer_id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "first_name": {
          "name": "first_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_name": {
          "name": "last_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "street": {
          "name": "street",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "additional_address": {
          "name": "additional_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "postalCode": {
          "name": "postalCode",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "city": {
          "name": "city",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "country": {
          "name": "country",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "definition": "select \"customer\".\"customer_id\", \"customer\".\"created_at\", \"customer\".\"first_name\", \"customer\".\"last_name\", \"customer\".\"email\", \"customer\".\"phone_number\", \"customer\".\"street\", \"customer\".\"additional_address\", \"customer\".\"postalCode\", \"customer\".\"city\", \"customer\".\"country\", \n\t\t\t\t\tCOALESCE(\n\t\t\t\t\t\tSTRING_AGG(\n\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\tWHEN \"pet\".\"pet_id\" IS NULL THEN NULL\n\t\t\t\t\t\t\t\tWHEN \"species\".\"name\" IS NOT NULL THEN (COALESCE(\"pet\".\"name\", '(Ohne Name)') || ' (' || \"species\".\"name\" || ')')\n\t\t\t\t\t\t\t\tELSE COALESCE(\"pet\".\"name\", '(Ohne Name)')\n\t\t\t\t\t\t\tEND,\n\t\t\t\t\t\t\t', ' ORDER BY \"pet\".\"pet_id\")\n\t\t\t\t\t\tFILTER (WHERE \"pet\".\"pet_id\" IS NOT NULL),\n\t\t\t\t\t\t'')\n\t\t\t\t\t as \"pets_line\", \n\t\t\t\t\tCOALESCE(\n\t\t\t\t\t\tSTRING_AGG(LOWER(CONCAT_WS(' ', \"pet\".\"name\", \"pet\".\"breed\", \"species\".\"name\")), ' ' ORDER BY \"pet\".\"pet_id\")\n\t\t\t\t\t\tFILTER (WHERE \"pet\".\"pet_id\" IS NOT NULL),\n\t\t\t\t\t\t''\n\t\t\t\t\t)\n\t\t\t\t as \"pets_text\", \n\t\t\t\t\tEXISTS(\n\t\t\t\t\t\tSELECT 1\n\t\t\t\t\t\tFROM \"customer_consent\"\n\t\t\t\t\t\tWHERE \"customer_consent\".\"customer_id\" = \"customer\".\"customer_id\" AND \"customer_consent\".\"is_latest\" = TRUE\n\t\t\t\t\t)\n\t\t\t\t as \"has_consent\" from \"customer\" left join \"pet\" on \"pet\".\"customer_id\" = \"customer\".\"customer_id\" left join \"species\" on \"species\".\"species_id\" = \"pet\".\"species_id\" group by \"customer\".\"customer_id\", \"customer\".\"created_at\", \"customer\".\"first_name\", \"customer\".\"last_name\", \"customer\".\"email\", \"customer\".\"phone_number\", \"customer\".\"street\", \"customer\".\"additional_address\", \"customer\".\"postalCode\", \"customer\".\"city\", \"customer\".\"country\"",
      "name": "customer_search_view",
      "schema": "public",
      "isExisting": false,
      "with": {
        "securityInvoker": true
      },
      "materialized": false
    }
  },
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}